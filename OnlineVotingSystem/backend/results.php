<?php $conn = new mysqli("localhost", "root", "", "votingsystem"); $sql = "SELECT vote_choice, COUNT(*) as total_votes FROM votes GROUP BY vote_choice"; $result = $conn->query($sql); $labels = []; $counts = []; while ($row = $result->fetch_assoc()) { $labels[] = $row['vote_choice']; $counts[] = $row['total_votes']; } ?> <!DOCTYPE html> <html> <head> <meta charset="UTF-8"> <title>Voting Results</title> <meta http-equiv="refresh" content="10"> <link rel="stylesheet" href="../frontend/style.css"> <style> .results-container { max-width: 700px; margin: 50px auto; padding: 30px; background-color: #fff; border-radius: 12px; box-shadow: 0 0 12px rgba(0, 0, 0, 0.1); } h2 { text-align: center; color: #333; margin-bottom: 25px; } table { width: 100%; border-collapse: collapse; margin-bottom: 30px; } th, td { border: 1px solid #ccc; padding: 10px; text-align: center; } th { background-color: #f5f5f5; } canvas { width: 100% !important; height: auto !important; margin-top: 20px; } .toggle-btn { display: block; margin: 0 auto 20px auto; padding: 10px 20px; background-color: #0066cc; color: white; border: none; border-radius: 8px; cursor: pointer; } .toggle-btn:hover { background-color: #004c99; } </style> </head> <body> <div class="results-container"> <h2>üó≥Ô∏è Voting Results</h2> <table> <tr> <th>Candidate</th> <th>Total Votes</th> </tr> <?php for ($i = 0; $i < count($labels); $i++) { echo "<tr><td>" . $labels[$i] . "</td><td>" . $counts[$i] . "</td></tr>"; } ?> </table>
<button class="toggle-btn" onclick="toggleChart()">Switch to Pie Chart</button>
<canvas id="voteChart"></canvas>
</div> <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <script> const labels = <?php echo json_encode($labels); ?>; const data = <?php echo json_encode($counts); ?>; const colors = ['#007bff', '#28a745', '#ffc107', '#dc3545', '#6f42c1']; const ctx = document.getElementById('voteChart').getContext('2d'); let currentType = 'bar'; let voteChart = new Chart(ctx, { type: currentType, data: { labels: labels, datasets: [{ label: 'Vote Count', data: data, backgroundColor: colors, borderRadius: 8 }] }, options: { responsive: true, plugins: { legend: { display: currentType === 'pie' }, title: { display: true, text: 'Vote Count', font: { size: 18 } } }, scales: currentType === 'bar' ? { y: { beginAtZero: true, precision: 0 } } : {} } }); function toggleChart() { voteChart.destroy(); currentType = currentType === 'bar' ? 'pie' : 'bar'; document.querySelector('.toggle-btn').textContent = currentType === 'bar' ? 'Switch to Pie Chart' : 'Switch to Bar Chart'; voteChart = new Chart(ctx, { type: currentType, data: { labels: labels, datasets: [{ label: 'Vote Count', data: data, backgroundColor: colors, borderRadius: 8 }] }, options: { responsive: true, plugins: { legend: { display: currentType === 'pie' }, title: { display: true, text: 'Vote Count', font: { size: 18 } } }, scales: currentType === 'bar' ? { y: { beginAtZero: true, precision: 0 } } : {} } }); } </script> </body> </html>
